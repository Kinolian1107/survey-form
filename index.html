<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•·ç…§è¼”å…·ä¾›æ‡‰é …ç›®èª¿æŸ¥è¡¨</title>
    <style>
        /* æ¨£å¼è¨­å®šå€åŸŸ (CSS) - æ‚¨ä¸éœ€è¦ä¿®æ”¹é€™è£¡ */
        :root {
            --primary: #0284c7;
            --bg: #f0f9ff;
            --border: #e2e8f0;
        }

        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background: var(--bg);
            padding: 20px;
            color: #334155;
        }

        .container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        h2 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #64748b;
            font-size: 0.9em;
            margin-bottom: 30px;
        }

        .vendor-info {
            background: #e0f2fe;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #bae6fd;
        }

        .vendor-info label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .vendor-info input {
            width: 98%;
            padding: 10px;
            border: 1px solid #94a3b8;
            border-radius: 5px;
            font-size: 16px;
        }

        .form-row {
            margin-bottom: 15px;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .accordion {
            margin-bottom: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .accordion-header {
            background: #fff;
            padding: 15px 20px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: 0.2s;
        }

        .accordion-header:hover {
            background: #f8fafc;
            color: var(--primary);
        }

        .accordion-header.active {
            background: var(--primary);
            color: white;
        }

        .accordion-content {
            display: none;
            padding: 20px;
            background: #fff;
            border-top: 1px solid var(--border);
        }

        .accordion-content.show {
            display: block;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .checkbox-item:hover {
            background: #f1f5f9;
        }

        .checkbox-item input {
            margin-right: 10px;
            transform: scale(1.2);
            cursor: pointer;
        }

        .footer-actions {
            margin-top: 30px;
            text-align: center;
            border-top: 2px solid #e2e8f0;
            padding-top: 20px;
        }

        button {
            padding: 15px 40px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            transition: 0.2s;
        }

        .btn-submit {
            background: #0284c7;
        }

        .btn-submit:hover {
            background: #0369a1;
        }

        .btn-submit:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .select-all-btn {
            font-size: 12px;
            background: #e2e8f0;
            color: #333;
            padding: 5px 10px;
            border-radius: 4px;
            margin-left: 10px;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 2s linear infinite;
            display: none;
            margin-left: 10px;
            vertical-align: middle;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <h2>é•·ç…§è¼”å…·ä¾›æ‡‰é …ç›®èª¿æŸ¥è¡¨</h2>
        <p class="subtitle">è«‹å‹¾é¸è²´å…¬å¸æœ‰æä¾›çš„é …ç›®ï¼Œå®Œæˆå¾Œé»æ“Šã€Œæäº¤è³‡æ–™ã€ã€‚</p>

        <div class="vendor-info">
            <div class="form-row">
                <label>å» å•†/å…¬å¸åç¨±ï¼š</label>
                <input type="text" id="vendorName" placeholder="å¿…å¡«ï¼Œè«‹è¼¸å…¥è²´å…¬å¸åç¨±">
            </div>
            <div class="form-row">
                <label>è¼”å…·é …ç›®ï¼š</label>
                <input type="text" id="assistiveItem" placeholder="å¿…å¡«ï¼Œè«‹è¼¸å…¥è¼”å…·é …ç›®">
            </div>
            <div class="form-row">
                <label>çµ±ä¸€ç·¨è™Ÿï¼š</label>
                <input type="text" id="taxId" placeholder="å¿…å¡«ï¼Œ8ä½æ•¸å­—ï¼Œä¾‹å¦‚ï¼š12345678">
            </div>
            <div class="form-row">
                <label>é›»è©±ï¼š</label>
                <input type="tel" id="phone" placeholder="å¿…å¡«ï¼Œæ ¼å¼ï¼šå€ç¢¼-è™Ÿç¢¼ï¼Œä¾‹å¦‚ï¼š02-12345678">
            </div>
            <div class="form-row">
                <label>ä¿¡ç®±ï¼š</label>
                <input type="email" id="email" placeholder="å¿…å¡«ï¼Œéœ€åŒ…å«@ï¼Œä¾‹å¦‚ï¼šexample@mail.com">
            </div>
            <div class="form-row">
                <label>åœ°å€ï¼š</label>
                <input type="text" id="address" placeholder="å¿…å¡«ï¼Œè«‹è¼¸å…¥å…¬å¸åœ°å€">
            </div>
            <div class="form-row">
                <label>è² è²¬äººå§“åï¼š</label>
                <input type="text" id="contactName" placeholder="å¿…å¡«ï¼Œè«‹è¼¸å…¥è² è²¬äººå§“å">
            </div>
            <div class="form-row">
                <label>è² è²¬äººèº«ä»½è­‰å­—è™Ÿï¼š</label>
                <input type="text" id="contactId" placeholder="å¿…å¡«ï¼Œè‹±æ–‡å­—æ¯+9ä½æ•¸å­—ï¼Œä¾‹å¦‚ï¼šA123456789">
            </div>
            <div class="form-row">
                <label>æä¾›èº«éšœè¼”å…·é …ç›®ï¼š</label>
                <input type="text" id="disabilityItems" placeholder="å¿…å¡«ï¼Œè«‹è¼¸å…¥æä¾›çš„èº«éšœè¼”å…·é …ç›®">
            </div>
        </div>

        <div id="formContainer"></div>

        <div class="footer-actions">
            <button id="submitBtn" class="btn-submit" onclick="submitData()">
                ğŸš€ æäº¤è³‡æ–™ <div class="loader" id="loader"></div>
            </button>
        </div>
    </div>

    <script>
        // =======================================================================
        // æ­¥é©Ÿï¼šè«‹å°‡ä¸‹æ–¹å¼•è™Ÿ " " ä¸­é–“çš„ç¶²å€ï¼Œæ›æˆæ‚¨åœ¨ Google Apps Script éƒ¨ç½²å¾Œå–å¾—çš„ç¶²å€
        // =======================================================================

        const scriptURL = "https://script.google.com/macros/s/AKfycbxLARHKw5PQQSLe9Mnc2cg7qvEbMLnp9dFYNBmZmdGbw1VZBATCcwJAhS_dNZVicEB5/exec";

        // =======================================================================
        // â–²â–²â–²â–²â–²â–²â–²â–²â–² ä¿®æ”¹ä¸Šé¢é€™ä¸€è¡Œå°±å¥½ â–²â–²â–²â–²â–²â–²â–²â–²â–²
        // =======================================================================

        const ltcData = {
            "è¼”å…·": [
                "é¦¬æ¡¶å¢é«˜å™¨åŠä¾¿ç›†æ¤…æˆ–æ²æµ´æ¤…", "å–®æ”¯æ´æ–-ä¸éŠ¹é‹¼è£½", "å–®æ”¯æ´æ–-é‹è£½", "åŠ©è¡Œå™¨", "å¸¶è¼ªå‹åŠ©æ­¥è»Š",
                "è¼ªæ¤…-Aæ¬¾ï¼ˆéè¼•é‡åŒ–é‡ç”¢å‹ï¼‰", "è¼ªæ¤…-Bæ¬¾ï¼ˆè¼•é‡åŒ–é‡ç”¢å‹ï¼‰", "è¼ªæ¤…-Cæ¬¾ï¼ˆé‡èº«è¨‚è£½å‹ï¼‰",
                "è¼ªæ¤…é™„åŠ åŠŸèƒ½-Aæ¬¾ï¼ˆå…·åˆ©æ–¼ç§»ä½åŠŸèƒ½ï¼‰", "è¼ªæ¤…é™„åŠ åŠŸèƒ½-Bæ¬¾ï¼ˆå…·ä»°èººåŠŸèƒ½ï¼‰", "è¼ªæ¤…é™„åŠ åŠŸèƒ½-Cæ¬¾ï¼ˆå…·ç©ºä¸­å‚¾å€’åŠŸèƒ½ï¼‰",
                "æ“ºä½ç³»çµ±-Aæ¬¾ï¼ˆå¹³é¢å‹è¼ªæ¤…èƒŒé ï¼‰", "æ“ºä½ç³»çµ±-Bæ¬¾ï¼ˆæ›²é¢é©å½¢è¼ªæ¤…èƒŒé ï¼‰", "æ“ºä½ç³»çµ±-Cæ¬¾ï¼ˆè¼ªæ¤…è»€å¹¹å´æ”¯æ’æ¶ï¼‰",
                "æ“ºä½ç³»çµ±-Dæ¬¾ï¼ˆè¼ªæ¤…é ­é ç³»çµ±ï¼‰", "é›»å‹•è¼ªæ¤…ï¼ˆå«åŠ è£æ²™ç™¼å‹åº§æ¤…ã€æ“ºä½å‹åº§æ¤…ã€é›»å‹•è®Šæ›å§¿å‹¢åŠŸèƒ½ã€æˆ–ä½¿ç”¨éæ¯”ä¾‹å¼æ§åˆ¶å™¨ï¼‰",
                "é›»å‹•ä»£æ­¥è»Š", "ç§»ä½è…°å¸¶", "ç§»ä½æ¿", "äººåŠ›ç§»ä½åŠå¸¶", "ç§»ä½æ»‘å¢Š-Aæ¬¾", "ç§»ä½æ»‘å¢Š-Bæ¬¾", "ç§»ä½è½‰ç›¤",
                "ç§»ä½æ©Ÿï¼ˆå«ç§»ä½æ©ŸåŠå¸¶ï¼‰", "ç§»ä½æ©ŸåŠå¸¶", "é›»è©±æ“´éŸ³å™¨", "é›»è©±é–ƒå…‰éœ‡å‹•å™¨", "ç«è­¦é–ƒå…‰è­¦ç¤ºå™¨",
                "é–€éˆ´é–ƒå…‰å™¨", "ç„¡ç·šéœ‡å‹•è­¦ç¤ºå™¨", "è¡£è‘—ç”¨è¼”å…·", "å±…å®¶ç”¨ç”Ÿæ´»è¼”å…·", "é£²é£Ÿç”¨è¼”å…·",
                "æ°£å¢ŠåºŠ-Aæ¬¾", "æ°£å¢ŠåºŠ-Bæ¬¾", "è¼ªæ¤…åº§å¢Š-Aæ¬¾ï¼ˆé€£é€šç®¡å‹æ°£å›Šæ°£å¢Šåº§-å¡‘è† æè³ªï¼‰",
                "è¼ªæ¤…åº§å¢Š-Bæ¬¾ï¼ˆé€£é€šç®¡å‹æ°£å›Šæ°£å¢Šåº§-æ©¡è† æè³ªï¼‰", "è¼ªæ¤…åº§å¢Š-Cæ¬¾ï¼ˆæ¶²æ…‹å‡è† åº§å¢Šï¼‰",
                "è¼ªæ¤…åº§å¢Š-Dæ¬¾ï¼ˆå›ºæ…‹å‡è† åº§å¢Šï¼‰", "è¼ªæ¤…åº§å¢Š-Eæ¬¾ï¼ˆå¡«å……å¼æ°£å›Šæ°£å¢Šåº§ï¼‰", "è¼ªæ¤…åº§å¢Š-Fæ¬¾ï¼ˆäº¤æ›¿å……æ°£å‹åº§å¢Šï¼‰",
                "è¼ªæ¤…åº§å¢Š-Gæ¬¾ï¼ˆé‡è£½å‹åº§å¢Šï¼‰", "å±…å®¶ç”¨ç…§é¡§åºŠ", "å±…å®¶ç”¨ç…§é¡§åºŠ-é™„åŠ åŠŸèƒ½Aæ¬¾ï¼ˆåºŠé¢å‡é™åŠŸèƒ½ï¼‰",
                "å±…å®¶ç”¨ç…§é¡§åºŠ-é™„åŠ åŠŸèƒ½Bæ¬¾ï¼ˆé›»å‹•å‡é™åŠŸèƒ½ï¼‰"
            ],
            "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„æœå‹™": [
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ‰¶æ‰‹", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-å¯å‹•å¼æ‰¶æ‰‹", "å¯æ”œå¼æ–œå¡è¨­å‚™-éå›ºå®šå¼æ–œå¡æ¿Aæ¬¾",
                "å¯æ”œå¼æ–œå¡è¨­å‚™-éå›ºå®šå¼æ–œå¡æ¿Bæ¬¾", "å¯æ”œå¼æ–œå¡è¨­å‚™-éå›ºå®šå¼æ–œå¡æ¿Cæ¬¾", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-å›ºå®šå¼æ–œå¡é“",
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ¶é«˜å¼å’Œå¼åœ°æ¿æ‹†é™¤", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-åå…‰è²¼æ¢æˆ–æ¶ˆå…‰", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-éš”é–“",
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-é˜²æ»‘æªæ–½", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-é–€Aæ¬¾", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-é–€Bæ¬¾",
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ°´é¾é ­", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ”¹å–„æµ´ç¼¸ï¼ˆæ–°å¢ã€æ”¹æ›ã€ç§»é™¤-å±…å®¶ç’°å¢ƒæ”¹å–„å«åŸè™•å¡«è£œï¼‰",
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ”¹å–„æ´—è‡‰å°ï¼ˆæ§½ï¼‰ï¼ˆæ–°å¢ã€æ”¹æ›ã€ç§»é™¤-å«åŸè™•å¡«è£œï¼‰",
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ”¹å–„é¦¬æ¡¶ï¼ˆæ–°å¢ã€æ”¹æ›ã€ç§»é™¤-å«åŸè™•å¡«è£œï¼‰", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-å£æ›å¼æ·‹æµ´æ¤…ï¼ˆåºŠï¼‰",
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ”¹å–„æµç†å°ï¼ˆæ–°å¢ã€æ”¹æ›ï¼‰", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-æ”¹å–„æŠ½æ²¹ç…™æ©Ÿï¼ˆä½ç½®èª¿æ•´ï¼‰",
                "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-ç‰¹æ®Šç°¡æ˜“æ´—æ§½", "å±…å®¶ç„¡éšœç¤™ç’°å¢ƒæ”¹å–„-ç‰¹æ®Šç°¡æ˜“æµ´æ§½"
            ],
            "ç§Ÿè³ƒ": [
                "å¸¶è¼ªå‹åŠ©æ­¥è»Š(åŠ©è¡Œæ¤…)", "è¼ªæ¤…-Bæ¬¾(è¼•é‡åŒ–é‡ç”¢å‹)", "è¼ªæ¤…é™„åŠ åŠŸèƒ½-Aæ¬¾(å…·åˆ©æ–¼ç§»ä½åŠŸèƒ½)",
                "è¼ªæ¤…é™„åŠ åŠŸèƒ½-Bæ¬¾(å…·ä»°èººåŠŸèƒ½)", "è¼ªæ¤…é™„åŠ åŠŸèƒ½-Cæ¬¾(å…·ç©ºä¸­å‚¾å€’åŠŸèƒ½)", "é›»å‹•è¼ªæ¤…", "é›»å‹•ä»£æ­¥è»Š",
                "ç§»ä½æ©Ÿ", "æ°£å¢ŠåºŠ-Aæ¬¾", "æ°£å¢ŠåºŠ-Bæ¬¾", "å±…å®¶ç”¨ç…§é¡§åºŠ", "å±…å®¶ç”¨ç…§é¡§åºŠ-é™„åŠ åŠŸèƒ½Aæ¬¾(åºŠé¢å‡é™åŠŸèƒ½)",
                "å±…å®¶ç”¨ç…§é¡§åºŠ-é™„åŠ åŠŸèƒ½Bæ¬¾(é›»å‹•å‡é™åŠŸèƒ½)", "çˆ¬æ¢¯æ©Ÿ(å–®è¶Ÿ)", "çˆ¬æ¢¯æ©Ÿ(æœˆ)"
            ]
        };

        const container = document.getElementById('formContainer');

        // ç”¢ç”Ÿé¸å–®
        for (const [category, items] of Object.entries(ltcData)) {
            const section = document.createElement('div');
            section.className = 'accordion';
            section.innerHTML = `
            <div class="accordion-header" onclick="toggleAccordion(this)">
                <span>${category} <small>(${items.length}é …)</small></span> 
                <button class="select-all-btn" onclick="toggleSelectAll('${category}', event)">å…¨é¸/å–æ¶ˆ</button>
            </div>
            <div class="accordion-content">
                <div class="checkbox-grid">
                    ${items.map(item => `<label class="checkbox-item"><input type="checkbox" name="${category}" value="${item}">${item}</label>`).join('')}
                </div>
            </div>`;
            container.appendChild(section);
        }

        function toggleAccordion(header) {
            header.classList.toggle('active');
            header.nextElementSibling.classList.toggle('show');
        }

        function toggleSelectAll(category, event) {
            event.stopPropagation();
            const inputs = document.querySelectorAll(`input[name="${category}"]`);
            let allChecked = Array.from(inputs).every(i => i.checked);
            inputs.forEach(input => input.checked = !allChecked);
        }

        // å°ç£èº«åˆ†è­‰å­—è™Ÿé©—è­‰å‡½æ•¸
        function validateTaiwanId(id) {
            // æª¢æŸ¥æ ¼å¼ï¼š1å€‹è‹±æ–‡å­—æ¯ + 9å€‹æ•¸å­—
            if (!/^[A-Za-z][12]\d{8}$/.test(id)) {
                return false;
            }

            // å­—æ¯å°æ‡‰çš„æ•¸å­—è¡¨
            const letterMap = {
                'A': 10, 'B': 11, 'C': 12, 'D': 13, 'E': 14, 'F': 15, 'G': 16, 'H': 17,
                'I': 34, 'J': 18, 'K': 19, 'L': 20, 'M': 21, 'N': 22, 'O': 35, 'P': 23,
                'Q': 24, 'R': 25, 'S': 26, 'T': 27, 'U': 28, 'V': 29, 'W': 32, 'X': 30,
                'Y': 31, 'Z': 33
            };

            const firstLetter = id.charAt(0).toUpperCase();
            const letterValue = letterMap[firstLetter];
            if (!letterValue) return false;

            // è¨ˆç®—é©—è­‰ç¢¼
            const n1 = Math.floor(letterValue / 10);
            const n2 = letterValue % 10;

            const weights = [1, 9, 8, 7, 6, 5, 4, 3, 2, 1];
            const digits = [n1, n2];

            for (let i = 1; i < 10; i++) {
                digits.push(parseInt(id.charAt(i)));
            }

            let sum = 0;
            for (let i = 0; i < digits.length; i++) {
                sum += digits[i] * weights[i];
            }

            return sum % 10 === 0;
        }

        // æäº¤åŠŸèƒ½
        function submitData() {
            const vendorName = document.getElementById('vendorName').value.trim();
            const assistiveItem = document.getElementById('assistiveItem').value.trim();
            const taxId = document.getElementById('taxId').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const email = document.getElementById('email').value.trim();
            const address = document.getElementById('address').value.trim();
            const contactName = document.getElementById('contactName').value.trim();
            const contactId = document.getElementById('contactId').value.trim();
            const disabilityItems = document.getElementById('disabilityItems').value.trim();

            // ====== å¿…å¡«æ¬„ä½é©—è­‰ ======
            if (!vendorName) return alert("è«‹å¡«å¯«ã€Œå» å•†/å…¬å¸åç¨±ã€ï¼");
            if (!assistiveItem) return alert("è«‹å¡«å¯«ã€Œè¼”å…·é …ç›®ã€ï¼");
            if (!taxId) return alert("è«‹å¡«å¯«ã€Œçµ±ä¸€ç·¨è™Ÿã€ï¼");
            if (!phone) return alert("è«‹å¡«å¯«ã€Œé›»è©±ã€ï¼");
            if (!email) return alert("è«‹å¡«å¯«ã€Œä¿¡ç®±ã€ï¼");
            if (!address) return alert("è«‹å¡«å¯«ã€Œåœ°å€ã€ï¼");
            if (!contactName) return alert("è«‹å¡«å¯«ã€Œè² è²¬äººå§“åã€ï¼");
            if (!contactId) return alert("è«‹å¡«å¯«ã€Œè² è²¬äººèº«ä»½è­‰å­—è™Ÿã€ï¼");
            if (!disabilityItems) return alert("è«‹å¡«å¯«ã€Œæä¾›èº«éšœè¼”å…·é …ç›®ã€ï¼");

            // ====== çµ±ä¸€ç·¨è™Ÿé©—è­‰ï¼ˆ8ä½ç´”æ•¸å­—ï¼‰======
            if (!/^\d{8}$/.test(taxId)) {
                return alert("ã€Œçµ±ä¸€ç·¨è™Ÿã€æ ¼å¼éŒ¯èª¤ï¼\nè«‹è¼¸å…¥8ä½æ•¸å­—ã€‚");
            }

            // ====== é›»è©±æ ¼å¼é©—è­‰ï¼ˆæ•¸å­—-æ•¸å­—ï¼‰======
            if (!/^\d+-\d+$/.test(phone)) {
                return alert("ã€Œé›»è©±ã€æ ¼å¼éŒ¯èª¤ï¼\nè«‹ä½¿ç”¨ã€Œæ•¸å­—-æ•¸å­—ã€æ ¼å¼ï¼Œä¾‹å¦‚ï¼š02-12345678");
            }

            // ====== ä¿¡ç®±æ ¼å¼é©—è­‰ï¼ˆéœ€åŒ…å«@ï¼‰======
            if (!email.includes('@') || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                return alert("ã€Œä¿¡ç®±ã€æ ¼å¼éŒ¯èª¤ï¼\nè«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­ä¿¡ç®±åœ°å€ã€‚");
            }

            // ====== å°ç£èº«åˆ†è­‰å­—è™Ÿé©—è­‰ ======
            if (!validateTaiwanId(contactId)) {
                return alert("ã€Œè² è²¬äººèº«ä»½è­‰å­—è™Ÿã€æ ¼å¼éŒ¯èª¤ï¼\nè«‹è¼¸å…¥æœ‰æ•ˆçš„å°ç£èº«åˆ†è­‰å­—è™Ÿã€‚");
            }

            // æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦å·²ç¶“æ›¿æ›ç¶²å€
            if (scriptURL.includes("æ‚¨çš„ç¶²å€")) {
                alert("âš ï¸ è¨­å®šå°šæœªå®Œæˆï¼\n\nè«‹æ‰“é–‹ html æª”æ¡ˆï¼Œæ‰¾åˆ° 'const scriptURL' é€™ä¸€è¡Œï¼Œ\nä¸¦å°‡ç¶²å€æ›æˆæ‚¨åœ¨ Google Apps Script å–å¾—çš„ç¶²å€ã€‚");
                return;
            }

            let allItems = [];
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(cb => {
                allItems.push(cb.value);
            });

            // ====== å‹¾é¸é …ç›®é©—è­‰ï¼ˆè‡³å°‘å‹¾é¸ä¸€å€‹ï¼‰======
            if (allItems.length === 0) return alert("è«‹è‡³å°‘å‹¾é¸ä¸€å€‹é …ç›®ï¼");

            const btn = document.getElementById('submitBtn');
            const loader = document.getElementById('loader');
            btn.disabled = true;
            loader.style.display = 'inline-block';
            btn.innerHTML = 'è³‡æ–™å‚³é€ä¸­... <div class="loader" style="display:inline-block"></div>';

            const payload = JSON.stringify({
                vendor: vendorName,
                assistiveItem: assistiveItem,
                taxId: taxId,
                phone: phone,
                email: email,
                address: address,
                contactName: contactName,
                contactId: contactId,
                disabilityItems: disabilityItems,
                items: allItems.join('ã€')
            });

            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'text/plain' },
                body: payload
            }).then(response => {
                alert("âœ… æäº¤æˆåŠŸï¼æ„Ÿè¬æ‚¨çš„å¡«å¯«ã€‚");
                window.location.reload();
            }).catch(error => {
                console.error('Error:', error);
                alert("âŒ ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
                btn.disabled = false;
                btn.innerHTML = 'ğŸš€ æäº¤è³‡æ–™';
            });
        }
    </script>

</body>

</html>